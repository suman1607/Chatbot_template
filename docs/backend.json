
{
  "entities": {
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "uid": { "type": "string", "description": "The unique identifier for the user." },
        "email": { "type": "string", "description": "The email address of the user.", "format": "email" },
        "name": { "type": "string", "description": "The display name of the user." },
        "createdAt": { "type": "string", "format": "date-time", "description": "The date and time when the user was created." },
        "status": { "type": "string", "enum": ["active", "suspended"], "description": "The status of the user's account." }
      },
      "required": ["uid", "email", "createdAt", "status"]
    },
    "Workspace": {
      "title": "Workspace",
      "type": "object",
      "description": "Represents a user's workspace, containing settings and configurations.",
      "properties": {
        "ownerId": { "type": "string", "description": "The UID of the user who owns the workspace." },
        "name": { "type": "string", "description": "The name of the workspace." }
      },
      "required": ["ownerId", "name"]
    },
    "WorkspaceMember": {
      "title": "WorkspaceMember",
      "type": "object",
      "description": "Defines a user's role and permissions within a specific workspace.",
      "properties": {
        "role": { "type": "string", "enum": ["Owner", "Manager", "Agent", "Viewer"], "description": "The role of the member in the workspace." },
        "permissions": { "type": "array", "items": { "type": "string" }, "description": "A list of specific feature permissions granted to the member." },
        "invitedBy": { "type": "string", "description": "The UID of the user who invited this member." },
        "createdAt": { "type": "string", "format": "date-time", "description": "The timestamp when the member was added." }
      },
      "required": ["role", "permissions", "createdAt"]
    },
    "AiConfig": {
        "title": "AiConfig",
        "type": "object",
        "description": "Configuration for the AI's persona and behavior within a workspace.",
        "properties": {
            "systemPrompt": { "type": "string", "description": "The base instructions that define the AI's core behavior." },
            "persona": {
                "type": "object",
                "properties": {
                    "name": { "type": "string" },
                    "tone": { "type": "string", "enum": ["formal", "friendly", "expert"] },
                    "avatarUrl": { "type": "string", "format": "uri" }
                }
            },
            "lastTrainedAt": { "type": "string", "format": "date-time" },
            "modelVersion": { "type": "string" }
        }
    },
    "Knowledge": {
        "title": "Knowledge",
        "type": "object",
        "description": "A single piece of knowledge used to train the AI.",
        "properties": {
            "type": { "type": "string", "enum": ["file", "url", "faq", "text"] },
            "title": { "type": "string" },
            "sourceUrl": { "type": "string", "format": "uri" },
            "filePath": { "type": "string", "description": "Path to the file in Firebase Storage." },
            "sizeBytes": { "type": "number" },
            "status": { "type": "string", "enum": ["pending", "trained", "error"] },
            "createdBy": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" },
            "errorMessage": { "type": "string" }
        },
        "required": ["type", "title", "status", "createdBy", "createdAt"]
    },
    "TrainingRun": {
        "title": "TrainingRun",
        "type": "object",
        "description": "Represents a single AI training job.",
        "properties": {
            "status": { "type": "string", "enum": ["queued", "processing", "completed", "failed"] },
            "sources": { "type": "array", "items": { "type": "string" }, "description": "Array of knowledge document IDs used in this run." },
            "durationMs": { "type": "number" },
            "errorMessage": { "type": "string" },
            "startedAt": { "type": "string", "format": "date-time" },
            "completedAt": { "type": "string", "format": "date-time" },
            "initiatedBy": { "type": "string" }
        },
        "required": ["status", "sources", "initiatedBy", "startedAt"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/User" },
      "description": "Stores public user profile information."
    },
    "/workspaces/{workspaceId}": {
      "schema": { "$ref": "#/entities/Workspace" },
      "description": "Top-level settings for a workspace."
    },
    "/workspaces/{workspaceId}/members/{userId}": {
      "schema": { "$ref": "#/entities/WorkspaceMember" },
      "description": "Stores roles and permissions for users within a workspace."
    },
    "/workspaces/{workspaceId}/aiConfig": {
        "schema": { "$ref": "#/entities/AiConfig" },
        "description": "Singleton document containing the AI configuration for the workspace."
    },
    "/workspaces/{workspaceId}/knowledge/{docId}": {
        "schema": { "$ref": "#/entities/Knowledge" },
        "description": "Collection of knowledge source documents for AI training."
    },
    "/workspaces/{workspaceId}/trainingRuns/{runId}": {
        "schema": { "$ref": "#/entities/TrainingRun" },
        "description": "A log of all AI training jobs initiated for the workspace."
    }
  },
  "storage": {
      "/workspaces/{workspaceId}/knowledge/{fileName}": {
          "description": "Storage for uploaded knowledge files."
      },
      "/workspaces/{workspaceId}/persona/avatar.png": {
          "description": "Storage for the AI persona's avatar image."
      }
  }
}
